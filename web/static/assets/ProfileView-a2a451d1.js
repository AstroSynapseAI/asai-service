import{u as L,r as l,D as S,v as y,o as M,x as f,f as s,M as d,N as c,L as T,C as z,A as E,c as _}from"./index-0a93aef4.js";const F={class:"container-fluid p-0"},Z=s("h1",{class:"h3 mb-3"},"Account",-1),R={class:"card"},$={class:"card-body"},j={class:"container p-4"},q=s("h3",null,"User Information",-1),x={class:"row"},G={class:"col-6"},H={class:"form-floating mb-3"},J=s("label",{for:"username"},"Username",-1),K={class:"row"},O={class:"col-6"},Q={class:"form-floating mb-3"},W=s("label",{for:"firstName"},"First Name",-1),X={class:"col-6"},Y={class:"form-floating mb-3"},ss=s("label",{for:"lastName"},"Last Name",-1),es={class:"row"},as={class:"col-12"},os=["disabled"],ts=s("hr",null,null,-1),ls={key:0,class:"text-muted"},ns={class:"row"},rs={class:"col-6"},is={class:"form-floating mb-3"},ds=s("label",{for:"newEmail"},"New Email",-1),cs={class:"col-6"},us={class:"form-floating mb-3"},ms=s("label",{for:"confirmPassword"},"Confirm Email",-1),vs={key:0},hs={class:"row"},fs={class:"col-12"},_s=["disabled"],ps=s("hr",null,null,-1),ws=s("h3",null,"Change Password",-1),gs={class:"row"},bs={class:"col-6"},ys={class:"form-floating mb-3"},Es=s("label",{for:"newPassword"},"New Password",-1),Cs={class:"col-6"},Ps={class:"form-floating mb-3"},Ds=s("label",{for:"confirmPassword"},"Confirm Password",-1),Ns={key:0},Us={key:1},Is={class:"row"},Vs={class:"col-12"},ks=["disabled"],Ls={__name:"ProfileView",setup(Bs){const t=L(),u=l(""),n=l(""),r=l(""),v=l(""),h=l(""),b=l(""),m=l(""),p=l(""),w=l(!1),g=l(!1),i=S(),C=()=>{g.value=!0},D=y(()=>!u.value.trim()||!v.value.trim()||!h.value.trim()),N=y(()=>!n.value.trim()||!r.value.trim()||r.value.length<8||n.value!==r.value),U=y(()=>!P()),I=()=>{const e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return String(m.value).toLowerCase().match(e)},V=()=>m.value===p.value,P=()=>{var e=!1;return e=V(),e=I(),e},k=async()=>{w.value=!0;try{const e={username:u.value,first_name:v.value,last_name:h.value};t.account&&(e.account_id=t.account.ID),await t.saveProfile(t.current.ID,e),i.success("Profile updated successfully!")}catch(e){console.error(e),i.error("Error while updating profile. Please try again later.")}},B=async()=>{if(w.value=!0,!P()){i.error("Email is not valid or emails do not match.");return}try{await t.changeEmail(t.current.ID,{account_id:t.account.ID,email:m.value}),i.success("Email updated successfully!")}catch(e){console.error(e),i.error("Error while updating email. Please try again later.")}},A=async()=>{w.value=!0;try{await t.changePassword(t.current.ID,{password:n.value}),i.success("Password changed successfully!")}catch(e){console.error(e),i.error("Error while changing password. Please try again later.")}finally{w.value=!1}};return M(async()=>{u.value=t.current.username;try{await t.getUserAccounts(t.current.ID),t.account&&(u.value=t.account.username??"",v.value=t.account.first_name,h.value=t.account.last_name,b.value=t.account.email)}catch(e){console.error(e)}feather.replace()}),(e,a)=>(_(),f("div",F,[Z,s("div",R,[s("div",$,[s("div",j,[q,s("div",x,[s("div",G,[s("div",H,[d(s("input",{type:"text",class:"form-control",id:"username",placeholder:"Username","onUpdate:modelValue":a[0]||(a[0]=o=>u.value=o),onInput:a[1]||(a[1]=(...o)=>e.onUserDataChange&&e.onUserDataChange(...o))},null,544),[[c,u.value]]),J])])]),s("div",K,[s("div",O,[s("div",Q,[d(s("input",{type:"text",class:"form-control",id:"firstName",placeholder:"First Name","onUpdate:modelValue":a[2]||(a[2]=o=>v.value=o),onInput:a[3]||(a[3]=(...o)=>e.onUserDataChange&&e.onUserDataChange(...o))},null,544),[[c,v.value]]),W])]),s("div",X,[s("div",Y,[d(s("input",{type:"text",class:"form-control",id:"lastName",placeholder:"Last Name","onUpdate:modelValue":a[4]||(a[4]=o=>h.value=o),onInput:a[5]||(a[5]=(...o)=>e.onUserDataChange&&e.onUserDataChange(...o))},null,544),[[c,h.value]]),ss])])]),s("div",es,[s("div",as,[s("button",{class:"btn btn-primary float-end",onClick:k,disabled:D.value},"Save",8,os)])]),ts,s("h3",null,[T("Change Email "),b.value!=""?(_(),f("span",ls,"("+z(b.value)+")",1)):E("",!0)]),s("div",ns,[s("div",rs,[s("div",is,[d(s("input",{type:"email",class:"form-control",id:"newEmail",placeholder:"New Email","onUpdate:modelValue":a[6]||(a[6]=o=>m.value=o),onInput:a[7]||(a[7]=(...o)=>e.onEmailChange&&e.onEmailChange(...o))},null,544),[[c,m.value]]),ds])]),s("div",cs,[s("div",us,[d(s("input",{type:"email",class:"form-control",id:"confirmEmail",placeholder:"Confirm Email","onUpdate:modelValue":a[8]||(a[8]=o=>p.value=o),onInput:a[9]||(a[9]=(...o)=>e.onEmailChange&&e.onEmailChange(...o))},null,544),[[c,p.value]]),ms,g.value&&m.value!==p.value?(_(),f("div",vs," Emails do not match ")):E("",!0)])])]),s("div",hs,[s("div",fs,[s("button",{class:"btn btn-primary float-end",onClick:B,disabled:U.value},"Change Email",8,_s)])]),ps,ws,s("div",gs,[s("div",bs,[s("div",ys,[d(s("input",{type:"password",class:"form-control",id:"newPassword",placeholder:"New Password","onUpdate:modelValue":a[10]||(a[10]=o=>n.value=o),onInput:C},null,544),[[c,n.value]]),Es])]),s("div",Cs,[s("div",Ps,[d(s("input",{type:"password",class:"form-control",id:"confirmPassword",placeholder:"Confirm Password","onUpdate:modelValue":a[11]||(a[11]=o=>r.value=o),onInput:C},null,544),[[c,r.value]]),Ds,g.value&&n.value!==r.value?(_(),f("div",Ns," Passwords do not match ")):g.value&&(n.value.length<8||r.value.length<8)?(_(),f("div",Us," New password has to have more than 8 characters ")):E("",!0)])])]),s("div",Is,[s("div",Vs,[s("button",{class:"btn btn-primary float-end",onClick:A,disabled:N.value},"Change Password",8,ks)])])])])])]))}};export{Ls as default};
